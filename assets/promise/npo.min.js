
/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
(function UMD(a,c,b){c[a]=c[a]||b();if(typeof module!="undefined"&&module.exports){module.exports=c[a]}else{if(typeof define=="function"&&define.amd){define(function d(){return c[a]})}}})("Promise",typeof global!="undefined"?global:this,function DEF(){var f,j,v,k=Object.prototype.toString,h=(typeof setImmediate!="undefined")?function h(w){return setImmediate(w)}:setTimeout;try{Object.defineProperty({},"x",{});f=function f(y,x,z,w){return Object.defineProperty(y,x,{value:z,writable:true,configurable:w!==false})}}catch(e){f=function f(x,w,y){x[w]=y;return x}}v=(function t(){var B,z,y;function x(D,C){this.fn=D;this.self=C;this.next=void 0}return{add:function A(D,C){y=new x(D,C);if(z){z.next=y}else{B=y}z=y;y=void 0},drain:function w(){var C=B;B=z=j=void 0;while(C){C.fn.call(C.self);C=C.next}}}})();function r(x,w){v.add(x,w);if(!j){j=h(v.drain)}}function u(y){var x,w=typeof y;if(y!=null&&(w=="object"||w=="function")){x=y.then}return typeof x=="function"?x:false}function i(){for(var w=0;w<this.chain.length;w++){a(this,(this.state===1)?this.chain[w].success:this.chain[w].failure,this.chain[w])}this.chain.length=0}function a(x,w,z){var y,B;try{if(w===false){z.reject(x.msg)}else{if(w===true){y=x.msg}else{y=w.call(void 0,x.msg)}if(y===z.promise){z.reject(TypeError("Promise-chain cycle"))}else{if(B=u(y)){B.call(y,z.resolve,z.reject)}else{z.resolve(y)}}}}catch(A){z.reject(A)}}function n(z){var y,w=this;if(w.triggered){return}w.triggered=true;if(w.def){w=w.def}try{if(y=u(z)){r(function(){var B=new g(w);try{y.call(z,function D(){n.apply(B,arguments)},function A(){d.apply(B,arguments)})}catch(C){d.call(B,C)}})}else{w.msg=z;w.state=1;if(w.chain.length>0){r(i,w)}}}catch(x){d.call(new g(w),x)}}function d(x){var w=this;if(w.triggered){return}w.triggered=true;if(w.def){w=w.def}w.msg=x;w.state=2;if(w.chain.length>0){r(i,w)}}function l(A,x,z,y){for(var w=0;w<x.length;w++){(function B(C){A.resolve(x[C]).then(function D(E){z(C,E)},y)})(w)}}function g(w){this.def=w;this.triggered=false}function o(w){this.promise=w;this.state=0;this.triggered=false;this.chain=[];this.msg=void 0}function c(C){if(typeof C!="function"){throw TypeError("Not a function")}if(this.__NPO__!==0){throw TypeError("Not a promise")}this.__NPO__=1;var A=new o(this);this["then"]=function B(G,D){var F={success:typeof G=="function"?G:true,failure:typeof D=="function"?D:false};F.promise=new this.constructor(function E(I,H){if(typeof I!="function"||typeof H!="function"){throw TypeError("Not a function")}F.resolve=I;F.reject=H});A.chain.push(F);if(A.state!==0){r(i,A)}return F.promise};this["catch"]=function x(D){return this.then(void 0,D)};try{C.call(void 0,function z(D){n.call(A,D)},function w(D){d.call(A,D)})}catch(y){d.call(A,y)}}var b=f({},"constructor",c,false);c.prototype=b;f(b,"__NPO__",0,false);f(c,"resolve",function q(x){var w=this;if(x&&typeof x=="object"&&x.__NPO__===1){return x}return new w(function y(A,z){if(typeof A!="function"||typeof z!="function"){throw TypeError("Not a function")}A(x)})});f(c,"reject",function s(w){return new this(function x(z,y){if(typeof z!="function"||typeof y!="function"){throw TypeError("Not a function")}y(w)})});f(c,"all",function m(w){var x=this;if(k.call(w)!="[object Array]"){return x.reject(TypeError("Not an array"))}if(w.length===0){return x.resolve([])}return new x(function y(D,C){if(typeof D!="function"||typeof C!="function"){throw TypeError("Not a function")}var z=w.length,B=Array(z),A=0;l(x,w,function E(F,G){B[F]=G;if(++A===z){D(B)}},C)})});f(c,"race",function p(w){var x=this;if(k.call(w)!="[object Array]"){return x.reject(TypeError("Not an array"))}return new x(function y(A,z){if(typeof A!="function"||typeof z!="function"){throw TypeError("Not a function")}l(x,w,function B(C,D){A(D)},z)})});return c});var deferred=function(){var b={};b.promise=new Promise(function a(d,c){b.resolve=d;b.reject=c});return b};