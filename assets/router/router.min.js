/* @link http://krasimirtsonev.com/blog/article/A-modern-JavaScript-router-in-100-lines-history-api-pushState-hash-url */
var Router={routes:[],mode:null,root:"/",config:function(a){this.mode=a&&a.mode&&a.mode=="history"&&!!(history.pushState)?"history":"hash";this.root=a&&a.root?"/"+this.clearSlashes(a.root)+"/":"/";return this},getFragment:function(){var b="";if(this.mode==="history"){b=this.clearSlashes(decodeURI(location.pathname+location.search));b=b.replace(/\?(.*)$/,"");b=this.root!="/"?b.replace(this.root,""):b}else{var a=window.location.href.match(/#(.*)$/);b=a?a[1]:""}return this.clearSlashes(b)},clearSlashes:function(a){return a.toString().replace(/\/$/,"").replace(/^\//,"")},add:function(b,a){if(typeof b=="function"){a=b;b=""}this.routes.push({re:b,handler:a});return this},remove:function(c){for(var a=0,b;a<this.routes.length,b=this.routes[a];a++){if(b.handler===c||b.re.toString()===c.toString()){this.routes.splice(a,1);return this}}return this},flush:function(){this.routes=[];this.mode=null;this.root="/";return this},check:function(d){var b=d||this.getFragment();for(var c=0;c<this.routes.length;c++){var a=b.match(this.routes[c].re);if(a){a.shift();this.routes[c].handler.apply({},a);return this}}return this},listen:function(){var a=this;var c=a.getFragment();var b=function(){if(c!==a.getFragment()){c=a.getFragment();a.check(c)}};clearInterval(this.interval);this.interval=setInterval(b,50);return this},navigate:function(a){a=a?a:"";if(this.mode==="history"){history.pushState(null,null,this.root+this.clearSlashes(a))}else{window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+a}return this}};